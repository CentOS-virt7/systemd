From 643f845bf882489eeddeeb4d9115b07b39198693 Mon Sep 17 00:00:00 2001
From: Lennart Poettering <lennart@poettering.net>
Date: Wed, 10 Jun 2015 15:51:40 +0200
Subject: [PATCH] sd-bus: fix early exit when we lack all data in
 bus_get_owner_creds_dbus1()

(cherry picked from commit 3c42e8b281b092b4d10f24c80e21d69b0f232b96)
---
 src/libsystemd/sd-bus/bus-control.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/libsystemd/sd-bus/bus-control.c b/src/libsystemd/sd-bus/bus-control.c
index 43ddfc651d..b4ca177f76 100644
--- a/src/libsystemd/sd-bus/bus-control.c
+++ b/src/libsystemd/sd-bus/bus-control.c
@@ -980,7 +980,7 @@ static int bus_get_owner_creds_dbus1(sd_bus *bus, uint64_t mask, sd_bus_creds **
         pid_t pid = 0;
         int r;
 
-        if (!bus->ucred_valid && !isempty(bus->label))
+        if (!bus->ucred_valid && isempty(bus->label))
                 return -ENODATA;
 
         c = bus_creds_new();
