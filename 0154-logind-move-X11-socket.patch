From 51f829b44f56505f70a6cda544b67510a24abad6 Mon Sep 17 00:00:00 2001
From: Lennart Poettering <lennart@poettering.net>
Date: Tue, 17 Jan 2012 14:03:00 +0100
Subject: [PATCH] logind: move X11 socket (cherry picked from commit
 fc3c1c6e091ea16ad5600b145201ec535bbb5d7c)

---
 src/logind-session.c |    6 ++----
 1 files changed, 2 insertions(+), 4 deletions(-)

diff --git a/src/logind-session.c b/src/logind-session.c
index 58c70c3..555e952 100644
--- a/src/logind-session.c
+++ b/src/logind-session.c
@@ -380,15 +380,13 @@ static int session_link_x11_socket(Session *s) {
                 return -ENOENT;
         }
 
-        t = strappend(s->user->runtime_path, "/X11/display");
+        t = strappend(s->user->runtime_path, "/X11-display");
         if (!t) {
                 log_error("Out of memory");
                 free(f);
                 return -ENOMEM;
         }
 
-        mkdir_parents(t, 0755);
-
         if (link(f, t) < 0) {
                 if (errno == EEXIST) {
                         unlink(t);
@@ -641,7 +639,7 @@ static int session_unlink_x11_socket(Session *s) {
 
         s->user->display = NULL;
 
-        t = strappend(s->user->runtime_path, "/X11/display");
+        t = strappend(s->user->runtime_path, "/X11-display");
         if (!t) {
                 log_error("Out of memory");
                 return -ENOMEM;
